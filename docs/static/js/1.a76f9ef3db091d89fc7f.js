webpackJsonp([1],{"7BdX":function(t,s,o){"use strict";var e={props:{ratings:{type:Array,default:function(){return[]}},selectType:{type:Number,default:2},onlyContent:{type:Boolean,default:!1},desc:{type:Object,default:function(){return{all:"全部",positive:"满意",negative:"不满意"}}}},computed:{positive:function(){return this.ratings.filter(function(t){return 0===t.rateType})},negaitive:function(){return this.ratings.filter(function(t){return 1===t.rateType})}},methods:{select:function(t){this.$emit("ratingstype",t)},toggleContent:function(){this.$emit("ratingsOnContent",this.onlyContent)}}},i={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"ratingSelect"},[o("div",{staticClass:"ratingType"},[o("div",{staticClass:"block goodsAll",class:{active:2===t.selectType},on:{click:function(s){t.select(2)}}},[o("span",{staticClass:"text"},[t._v(t._s(t.desc.all))]),t._v(" "),o("span",{staticClass:"ratingSum"},[t._v(t._s(t.ratings.length))])]),t._v(" "),o("div",{staticClass:"block goodPositive",class:{active:0===t.selectType},on:{click:function(s){t.select(0)}}},[o("span",{staticClass:"text"},[t._v(t._s(t.desc.positive))]),t._v(" "),o("span",{staticClass:"ratingSum"},[t._v(t._s(t.positive.length))])]),t._v(" "),o("div",{staticClass:"block goodNegative",class:{active:1===t.selectType},on:{click:function(s){t.select(1)}}},[o("span",{staticClass:"text"},[t._v(t._s(t.desc.negative))]),t._v(" "),o("span",{staticClass:"ratingSum"},[t._v(t._s(t.negaitive.length))])])]),t._v(" "),o("div",{staticClass:"switch"},[o("span",{staticClass:"iconfont icon-gou",class:{active:t.onlyContent},on:{touchstart:t.toggleContent}}),t._v(" "),o("span",{staticClass:"text"},[t._v("只看有内容的评价")])])])},staticRenderFns:[]};var n=o("VU/8")(e,i,!1,function(t){o("odmS")},"data-v-e102fa26",null);s.a=n.exports},ILKo:function(t,s){},PXOj:function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=o("7+uW"),i={data:function(){return{foodNum:0}},props:{food:{type:Object,default:function(){return{oldPrice:""}}}},computed:{},methods:{addCart:function(){this.food.count?this.food.count++:e.a.set(this.food,"count",1)},decreaseCart:function(){this.food.count&&this.food.count--}}},n={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"buy"},[this.food.count?o("i",{staticClass:"minus iconfont icon-msnui-sub",on:{touchstart:t.decreaseCart}}):t._e(),t._v(" "),this.food.count?o("span",{staticClass:"count"},[t._v(t._s(this.food.count))]):t._e(),t._v(" "),o("i",{staticClass:"sum iconfont icon-jiahao",on:{touchstart:function(s){t.addCart()}}})])},staticRenderFns:[]};var a=o("VU/8")(i,n,!1,function(t){o("pj9t")},"data-v-05517475",null).exports,c={data:function(){return{isActive:!1,initY:0,scrollY:0}},props:{selectFoods:{type:Array},deliveryPrice:{type:Number},minPrice:{type:Number}},mounted:function(){this.scroll={goodItem:{scrollY:0,recordY:0,listY:[],el:this.$refs.goodItem,cls:".goodItem"}}},computed:{totalPrice:function(){var t=0;return this.selectFoods.forEach(function(s){t+=s.price*s.count}),t},totalCount:function(){var t=0;return this.selectFoods.forEach(function(s){t+=s.count}),t}},watch:{selectFoods:function(t,s){t.length||(this.isActive=!1)}},methods:{ShowBlock:function(){this.selectFoods.length?this.isActive=!this.isActive:this.isActive=!1},clearAll:function(){this.selectFoods.forEach(function(t){t.count=0})},initScrollData:function(t,s){this.initY=Math.ceil(t.changedTouches[0].clientY)+Math.abs(s.goodItem.recordY)},startScroll:function(t,s){var o=s.goodItem.el;this.scrollY=s.goodItem.scrollY=s.goodItem.recordY=Math.ceil(t.changedTouches[0].clientY-this.initY),s.goodItem.scrollY,o.style.transition="none",o.style.top=Math.ceil(s.goodItem.scrollY)+"px"},entScroll:function(t){var s=t.goodItem.el,o=t.goodItem.el.querySelector(t.goodItem.cls+">ul");if(t.goodItem.scrollY<0){var e=s.clientHeight-o.scrollHeight;Math.abs(t.goodItem.scrollY)>=Math.abs(e)&&(t.goodItem.recordY=t.goodItem.scrollY=e,s.style.top=e+"px",s.style.transition="all 0.2s")}else s.getBoundingClientRect().top>174&&(s.style.top=t.goodItem.recordY=0,s.style.transition="all 0.2s")},acquireHeight:function(){return this.$refs.cart.clientHeight}},components:{BUY:a}},l={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{ref:"cart",staticClass:"cart"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"goodsType_wraper"},[o("div",{staticClass:"goodsType"},[o("div",{staticClass:"g_title"},[o("span",{staticClass:"g_cart"},[t._v("购物车")]),t._v(" "),o("span",{staticClass:"clear",on:{touchstart:t.clearAll}},[t._v("清空")])]),t._v(" "),o("div",{ref:"goodItem",staticClass:"goodItem"},[o("ul",t._l(t.selectFoods,function(s,e){return o("li",{key:e,staticClass:"typeItem",on:{touchstart:function(s){t.initScrollData(s,t.scroll)},touchmove:function(s){t.startScroll(s,t.scroll)},touchend:function(s){t.entScroll(t.scroll)}}},[o("span",{staticClass:"goodsName"},[t._v(t._s(s.name))]),t._v(" "),o("span",{staticClass:"goodPrice"},[t._v("￥"),o("span",{staticClass:"p-price"},[t._v(t._s(s.price*s.count))])]),t._v(" "),o("BUY",{attrs:{food:s}})],1)}))])])]),t._v(" "),o("div",{staticClass:"c-c",on:{touchstart:t.ShowBlock}},[o("div",{staticClass:"c-c-c",class:{c_c_count:t.selectFoods.length}},[o("span",{staticClass:"iconfont icon-gouwuche"})]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.totalCount,expression:"totalCount"}],staticClass:"count"},[o("span",[t._v(" "+t._s(t.totalCount))])])]),t._v(" "),o("div",{staticClass:"c-left"},[o("div",{staticClass:"c-price"},[o("span",{staticClass:"c-p-prize"},[t._v("￥"+t._s(t.totalPrice))])]),t._v(" "),o("div",{staticClass:"c-info"},[o("span",{staticClass:"c-i-info"},[t._v("另需配送费￥"+t._s(t.deliveryPrice)+"元")])])]),t._v(" "),o("div",{staticClass:"c-right"},[o("span",[t._v("￥"+t._s(t.minPrice)+"起送 ")])])])},staticRenderFns:[]};var r=o("VU/8")(c,l,!1,function(t){o("ILKo")},null,null).exports,d=o("Kxuj"),u=o("7BdX"),v=o("jr+k"),f={name:"goodsDetails",props:{food:{type:Object}},data:function(){return{isActive:!1,selectType:2,onlyContent:!1,initY:0,scrollY:0,desc:{all:"全部",positive:"推荐",negative:"吐槽"}}},mounted:function(){this.scroll={goodItem:{scrollY:0,recordY:0,listY:[],el:this.$refs.goodsDetails,cls:".goodsDetails"}}},filters:{formatDate:function(t){var s=new Date(t);return Object(v.a)(s,"yyyy-MM-dd hh:mm:ss")}},methods:{showBlock:function(){this.isActive=!this.isActive,this.selectType=2,this.onlyContent=!0},transfrom:function(t){this.selectType=t},toggleContent:function(){this.onlyContent=!this.onlyContent},addFoot:function(){this.food.count?this.food.count++:e.a.set(this.food,"count",1)},itive:function(t){return!!t.rateType},needShow:function(t,s){return!(this.onlyContent&&!s)&&(2===this.selectType||t===this.selectType)},initScrollData:function(t,s){this.initY=Math.ceil(t.changedTouches[0].clientY)+Math.abs(s.goodItem.recordY)},startScroll:function(t,s){var o=s.goodItem.el;this.scrollY=s.goodItem.scrollY=s.goodItem.recordY=Math.ceil(t.changedTouches[0].clientY-this.initY),s.goodItem.scrollY<0?(o.style.transition="none",o.style.top=Math.ceil(s.goodItem.scrollY)+"px"):(o.style.top=Math.ceil(s.goodItem.scrollY)+"px",o.style.transition="none")},entScroll:function(t){var s=t.goodItem.el,o=t.goodItem.el;if(t.goodItem.scrollY<0){var e=s.clientHeight-o.scrollHeight;Math.abs(t.goodItem.scrollY)>=Math.abs(e)&&(t.goodItem.recordY=t.goodItem.scrollY=e,s.style.top=e+"px",s.style.transition="all 0.2s")}else s.getBoundingClientRect().top>0&&(s.style.top=t.goodItem.recordY=0,s.style.transition="all 0.5s")}},components:{PRICE:a,SPLICT:d.a,RATING:u.a}},h={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("transition",{attrs:{"enter-active-class":"animated fadeInRight","leave-active-class":"animated fadeOutRight"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"goodWrapper"},[o("div",{ref:"goodsDetails",staticClass:"goodsDetails",on:{touchstart:function(s){t.initScrollData(s,t.scroll)},touchmove:function(s){t.startScroll(s,t.scroll)},touchend:function(s){t.entScroll(t.scroll)}}},[o("div",{staticClass:"imgHeader"},[o("img",{attrs:{src:t.food.image,alt:""}}),t._v(" "),o("div",[o("span",{staticClass:"iconfont icon-back",on:{touchstart:t.showBlock}})])]),t._v(" "),o("div",{staticClass:"goodContent"},[o("div",{staticClass:"content"},[o("h1",{staticClass:"title"},[t._v(t._s(t.food.name))]),t._v(" "),o("div",{staticClass:"extra"},[o("span",{staticClass:"sellCount"},[t._v("月售"+t._s(t.food.sellCount)+"份")]),t._v(" "),o("span",{staticClass:"rating"},[t._v("好评率"+t._s(t.food.rating)+"%")])]),t._v(" "),o("div",{staticClass:"price"},[o("span",[t._v("￥"),o("span",{staticClass:"p-price"},[t._v(t._s(t.food.price))])]),t._v(" "),t.food.oldPrice?o("span",{staticClass:"p-floor"},[t._v("￥"+t._s(t.food.oldPrice))]):t._e(),t._v(" "),o("div",{staticClass:"prizeWrapper"},[t.food.count||0===!t.food.count?o("PRICE",{attrs:{food:t.food}}):t._e(),t._v(" "),t.food.count&&0!==t.food.count?t._e():o("div",{staticClass:"addCart",on:{touchstart:t.addFoot}},[o("span",[t._v("加入购物车")])])],1)])]),t._v(" "),o("SPLICT"),t._v(" "),o("div",{staticClass:"goodIntroduce"},[o("h1",{staticClass:"title"},[t._v("商品介绍")]),t._v(" "),o("aside",[o("p",{staticClass:"text"},[t._v(t._s(t.food.info))])])]),t._v(" "),o("SPLICT"),t._v(" "),o("div",{staticClass:"goodsRating"},[o("h1",{staticClass:"title"},[t._v("商品评价")]),t._v(" "),o("RATING",{attrs:{desc:t.desc,selectType:t.selectType,onlyContent:t.onlyContent,ratings:t.food.ratings},on:{ratingstype:t.transfrom,ratingsOnContent:t.toggleContent}}),t._v(" "),o("div",{staticClass:"ratingsContent"},[o("ul",{directives:[{name:"show",rawName:"v-show",value:t.food.ratings&&t.food.ratings.length,expression:"food.ratings && food.ratings.length"}]},t._l(t.food.ratings,function(s,e){return o("li",{directives:[{name:"show",rawName:"v-show",value:t.needShow(s.rateType,s.text),expression:"needShow(val.rateType,val.text)"}],key:e,staticClass:"ratingItem"},[o("div",[o("p",{staticClass:"itemTime"},[t._v(t._s(t._f("formatDate")(s.rateTime)))]),t._v(" "),o("p",{staticClass:"itemUserInfo"},[t._v(t._s(s.username)),o("img",{attrs:{src:s.avatar}})])]),t._v(" "),o("p",{staticClass:"ratingText"},[o("span",{staticClass:"iconfont",class:[t.itive(s)?"icon-zan4":"icon-zan"]}),t._v(t._s(s.text))])])})),t._v(" "),t.food.ratings&&t.food.ratings.length?t._e():o("div",{staticClass:"noRating"},[o("p",[t._v("暂无评价!")])])])],1)],1)])])])},staticRenderFns:[]};var p=o("VU/8")(f,h,!1,function(t){o("o/sN")},"data-v-1386dac0",null).exports,g={name:"goods",props:{seller:{type:Object}},data:function(){return{goods:[],initY:0,scrollY:0,listH:[],foodList:{}}},created:function(){var t=this;this.axios.get("goods").then(function(s){t.goods=s.data.data}),this.classMap=["decrease","discount","special","invoice","guarantee"]},mounted:function(){this.scroll={menu:{scrollY:0,recordY:0,listY:[],el:this.$refs.menu,cls:".menuItem",parent:".menu",index:0},foods:{scrollY:0,recordY:0,listY:[],el:this.$refs.foods,cls:".foodsList",parent:".foods"}}},computed:{selectFoods:function(){var t=[];return this.goods.forEach(function(s){s.foods.forEach(function(s){s.count&&t.push(s)})}),t}},methods:{initScrollData:function(t,s){this.initY=Math.ceil(t.changedTouches[0].clientY)+Math.abs(s.recordY)},startScroll:function(t,s){var o=s.el;this.scrollY=s.scrollY=s.recordY=Math.ceil(t.changedTouches[0].clientY-this.initY),s.scrollY,o.style.transition="none",o.style.top=Math.ceil(s.scrollY)+"px"},entScroll:function(t,s,o){var e=t.el,i=this.$refs.goods,n=t.el.querySelector(t.parent+">ul");if(t.scrollY<0){var a=this.$refs.cart.acquireHeight(),c=i.clientHeight-a-n.scrollHeight;Math.abs(t.scrollY)>=Math.abs(c)&&(t.recordY=t.scrollY=c,e.style.top=c+"px",e.style.transition="all 0.2s")}else e.getBoundingClientRect().top>174&&(e.style.top=t.recordY=0,e.style.transition="all 0.2s");".foodsList"===t.cls&&this.calculateHeight(t)},calculateHeight:function(t){var s=t.el.querySelectorAll(t.cls),o=0;t.listY=[],this.listH=[];for(var e=0;e<s.length;e++){o+=s[e].clientHeight,t.listY.push(o)}this.listH=t.listY},switchMenuIndex:function(){for(var t=0;t<this.listH.length;t++){var s=this.listH[t];if(Math.abs(this.scrollY)<=s)return this.scroll.menu.index=t,this.scroll.menu.index}return this.scroll.menu.index},toggleNav:function(t,s){this.calculateHeight(t);var o=t.el,e=s-1;e<0?(o.style.top="0px",o.style.transition="all 0.2s",this.scrollY=0,t.recordY=0):(this.scroll.menu.index=s,this.scrollY=this.listH[s],t.recordY=this.listH[e],o.style.top=-this.listH[e]+"px",o.style.transition="all 0.2s")},goodsDetail:function(){this.$refs.goodWrapper.showBlock()},acquire:function(t){this.foodList=t}},components:{cart:r,PRICE:a,goodsDetail:p}},_={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{ref:"goods",staticClass:"goods"},[o("div",{ref:"menu",staticClass:"menu"},[o("ul",t._l(t.goods,function(s,e){return o("li",{key:e,staticClass:"menuItem",class:{current:t.switchMenuIndex()===e},on:{click:function(s){t.toggleNav(t.scroll.foods,e)},touchstart:function(s){t.initScrollData(s,t.scroll.menu)},touchmove:function(s){t.startScroll(s,t.scroll.menu)},touchend:function(s){t.entScroll(t.scroll.menu,t.scroll.foods)}}},[o("p",{staticClass:"text"},[o("span",{directives:[{name:"show",rawName:"v-show",value:s.type>0,expression:"val.type > 0"}],staticClass:"icon",class:t.classMap}),t._v(" "),o("span",[t._v(" "+t._s(s.name))])])])}))]),t._v(" "),o("div",{ref:"foods",staticClass:"foods"},[o("ul",t._l(t.goods,function(s,e){return o("li",{key:e,staticClass:"foodsList",on:{touchstart:function(s){t.initScrollData(s,t.scroll.foods)},touchmove:function(s){t.startScroll(s,t.scroll.foods)},touchend:function(s){t.entScroll(t.scroll.foods,e,t.scroll.foods)}}},[o("h1",{staticClass:"title"},[t._v(" "+t._s(s.name))]),t._v(" "),o("ul",t._l(s.foods,function(s,e){return o("li",{key:e,staticClass:"foodItem",on:{touchstart:function(o){t.acquire(s)}}},[o("div",{staticClass:"icon",on:{touchstart:function(s){t.goodsDetail()}}},[o("img",{attrs:{src:s.icon}})]),t._v(" "),o("div",{staticClass:"f-conent"},[o("h2",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),o("p",{staticClass:"desc"},[t._v(t._s(s.description))]),t._v(" "),o("div",{staticClass:"extra"},[o("span",[t._v("月售"+t._s(s.sellCount)+"份")]),t._v(" "),o("span",[t._v("好评率"+t._s(s.rating)+"%")])]),t._v(" "),o("div",{staticClass:"price"},[o("span",[t._v("￥"),o("span",{staticClass:"p-price"},[t._v(t._s(s.price))])]),t._v(" "),s.oldPrice?o("span",{staticClass:"p-floor"},[t._v("￥"+t._s(s.oldPrice))]):t._e(),t._v(" "),o("PRICE",{attrs:{food:s}})],1)])])}))])}))]),t._v(" "),o("cart",{ref:"cart",attrs:{"select-foods":t.selectFoods,"delivery-price":t.seller.deliveryPrice,"min-price":t.seller.minPrice}}),t._v(" "),o("goodsDetail",{ref:"goodWrapper",attrs:{food:t.foodList}})],1)},staticRenderFns:[]};var m=o("VU/8")(g,_,!1,function(t){o("WaEL")},"data-v-15da9b8a",null);s.default=m.exports},WaEL:function(t,s){},"jr+k":function(t,s,o){"use strict";function e(t){return("00"+t).substr(t.length)}s.a=function(t,s){/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(t.getFullYear()+" ").substr(4-RegExp.$1.length)));var o={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var i in o)if(new RegExp("("+i+")").test(s)){var n=o[i]+"";s=s.replace(RegExp.$1,1===RegExp.$1.length?n:e(n))}return s}},"o/sN":function(t,s){},odmS:function(t,s){},pj9t:function(t,s){}});
//# sourceMappingURL=1.a76f9ef3db091d89fc7f.js.map